# üöÄ INVOICE AUTOMATION v1.4 - DEPLOYMENT GUIDE

## üìå VERSION INFO
- **Version:** v1.4
- **Date:** 2025-01-19
- **For:** Teatro Metamorfosis
- **Major Change:** OPTIMIZED SEARCH - Keywords in email SUBJECT only

---

## üÜï WHAT'S NEW IN v1.4?

### ‚ö° **OPTIMIZED SEARCH WORKFLOW**
**v1.3 and earlier:** Downloaded ALL emails with attachments, then filtered
**v1.4:** Gmail filters by SUBJECT keywords FIRST, only downloads matching emails

### üéØ **SEARCH LOCATION: EMAIL SUBJECT ONLY**
- Keywords searched in email **SUBJECT/ASUNTO** field only
- NOT searched in email body
- NOT searched in attachment filenames
- Filtering happens at Gmail API level = MUCH FASTER

### üåç **MULTI-LANGUAGE SUPPORT**
Gmail's `subject:` search operator works universally across ALL languages:

| Language | UI Shows | Search Operator Used |
|----------|----------|---------------------|
| English  | Subject: | `subject:`          |
| Spanish  | Asunto:  | `subject:`          |
| German   | Betreff: | `subject:`          |
| French   | Objet:   | `subject:`          |
| Italian  | Oggetto: | `subject:`          |
| Portuguese | Assunto: | `subject:`        |

**The script works with Gmail in ANY language!**

### üî§ CASE-INSENSITIVE MATCHING
All keywords work regardless of capitalization:
- `Factura` = `factura` = `FACTURA` = `FACTURA!`

### üìã KEYWORDS (24 TOTAL)

**Original Keywords (10):**
- invoice, invoices
- factura, facturas
- pago, pagos
- recibo, receipt
- payment, payout

**Invoice Abbreviations (4):**
- fra, ftra, fac, fact

**Payroll Terms (6):**
- n√≥mina, nomina, n√∂mina, nom
- hoja de pago, hojas de pago

**Additional Terms (3):**
- justificante de presentaci√≥n
- limitador de sonido caducado
- credit note

---

## üìç FILE LOCATIONS

### Main Script File:
```
C:\Users\sarah\Desktop\CLAUDE DATABASE DOCS\PROJECTS\INVOICE EXTRACT AUTOMATION\phase1-automation\INVOICE_AUTOMATION_FINAL.gs
```

### Version Backup:
```
C:\Users\sarah\Desktop\CLAUDE DATABASE DOCS\PROJECTS\INVOICE EXTRACT AUTOMATION\phase1-automation\versions\v1.4_subject_search_only.gs
```

---

## üîß DEPLOYMENT STEPS

### Step 1: Access Google Apps Script
1. Go to https://script.google.com
2. Open your existing Teatro invoice automation project

### Step 2: Replace Code
1. Select ALL existing code (Ctrl+A)
2. Delete it
3. Copy ALL code from `INVOICE_AUTOMATION_FINAL.gs`
4. Paste into Google Apps Script editor
5. Click "Save" (disk icon)

### Step 3: Run Initial Setup
1. Select function: `firstRun`
2. Click "Run" (play button)
3. Authorize when prompted
4. Watch the execution log (View ‚Üí Execution log)
5. Wait for completion (5-15 minutes)

### Step 4: Check Results
Look for this in the execution log:
```
üìß Emails scanned: XXX
üìé Invoices found: XXX
üìÅ Files organized: XXX
üìä Data rows extracted: XXX
```

Check how many invoices it finds with the optimized subject search!

---

## üîç CUSTOMIZATION SECTION (FOR FUTURE SALES)

### How to Customize Keywords for Different Clients

The keywords are in the `CONFIG` object at the top of the script:

```javascript
invoiceKeywords: [
  // Add client-specific keywords here
  'invoice',
  'factura',
  'rechnung',  // German
  'fattura',   // Italian
  // etc...
],
```

### Multi-Language Keyword Examples

**Spanish:**
- factura, fra, fac, recibo, n√≥mina, pago

**English:**
- invoice, receipt, payment, payout, bill

**German:**
- rechnung, beleg, zahlung, quittung

**French:**
- facture, re√ßu, paiement, quittance

**Italian:**
- fattura, ricevuta, pagamento

**Portuguese:**
- fatura, recibo, pagamento

### How the Multi-Language Search Works

1. **Gmail Search Operator is Universal:**
   - The `subject:` operator works the same in ALL Gmail interfaces
   - Doesn't matter if the user's Gmail is in Spanish, German, French, etc.
   - Gmail's backend always uses `subject:` for the subject field

2. **Keywords are Language-Specific:**
   - You customize keywords based on the CLIENT's language/region
   - A Spanish client needs Spanish invoice terms: "factura", "recibo", etc.
   - A German client needs German invoice terms: "rechnung", "beleg", etc.

3. **Search Query Example:**
   ```
   subject:(factura OR invoice OR rechnung) has:attachment after:2025/01/01
   ```
   This works regardless of whether the Gmail interface is in English, Spanish, or German!

---

## üìä VERSION COMPARISON

| Version | Keywords | Search Method | Speed |
|---------|----------|---------------|-------|
| v1.0    | 7        | Filename only | Slow |
| v1.1    | 7        | Filename only | Slow |
| v1.2    | 7        | Filename only | Slow |
| v1.3    | 24       | Subject + Filename (after download) | Slow |
| **v1.4** | **24** | **Subject only (at Gmail level)** | **FAST** |

---

## üîß TROUBLESHOOTING

### "Authorization required"
- Click "Review Permissions"
- Choose your Google account
- Click "Advanced" ‚Üí "Go to [Project Name]"
- Click "Allow"

### "No invoices found"
- Check your email accounts have emails with keywords in SUBJECT
- Verify date range in CONFIG.scanStartDate
- Check execution log for search query used

### "Quota exceeded"
- Google limits: 20,000 emails per day
- Wait 24 hours and try again
- Or reduce date range in CONFIG.scanStartDate

---

## üìß SUPPORT

For issues or questions:
- Check execution log: View ‚Üí Execution log
- Review CONFIG settings at top of script
- Verify Gmail accounts and folder permissions

---

## üí∞ SYSTEM COSTS (IMPORTANT FOR CLIENTS)

### ‚úÖ **FREE COMPONENTS:**

| Component | Cost | Quota |
|-----------|------|-------|
| Google Apps Script | FREE | Cloud-based, no hosting costs |
| Gmail API | FREE | 20,000 emails/day |
| Google Drive API | FREE | Within existing Drive storage |
| Google Sheets API | FREE | Unlimited spreadsheets |

### üíµ **PAID COMPONENT:**

**Google Cloud Vision API** (OCR/Text Extraction)
- **Purpose:** Automatically reads text from invoice images/PDFs
- **First 1,000 requests/month:** FREE ‚úÖ
- **After 1,000 requests/month:** $1.50 per 1,000 requests

### üìä **COST EXAMPLES BY VOLUME:**

| Monthly Invoices | Vision API Cost | Total System Cost |
|-----------------|-----------------|-------------------|
| 100 invoices | $0 (free tier) | **$0/month** |
| 500 invoices | $0 (free tier) | **$0/month** |
| 1,000 invoices | $0 (free tier) | **$0/month** |
| 2,000 invoices | $1.50 | **$1.50/month** |
| 5,000 invoices | $6.00 | **$6.00/month** |
| 10,000 invoices | $13.50 | **$13.50/month** |

### üí° **CLIENT TALKING POINTS:**

**For Small Businesses (Teatro's case):**
- Teatro processes ~100-500 invoices/month
- **Monthly cost: $0** (under free tier)
- **ROI:** Saves hours of manual data entry for $0

**For Medium Businesses:**
- Process 2,000-3,000 invoices/month
- **Monthly cost: $1.50-3.00**
- **ROI:** Minimal cost vs. employee time saved

**Cost-Free Option Available:**
- Vision API can be disabled (manual data entry required)
- System still organizes files automatically
- **Monthly cost: $0** guaranteed

---

## üéØ SELLING POINTS (FOR PRODUCT VERSION)

### Universal Language Support
‚úÖ Works with Gmail in **any language**
‚úÖ No code changes needed for different countries
‚úÖ Simply customize keywords for client's region

### Fast & Efficient
‚úÖ Filters at Gmail API level (not after downloading)
‚úÖ Only processes relevant emails
‚úÖ Saves bandwidth and execution time

### Cost Effective
‚úÖ **$0-3/month** for most small businesses
‚úÖ No hosting or server costs
‚úÖ Uses existing Google Workspace
‚úÖ Option to disable Vision API for $0 cost

### Easy Customization
‚úÖ All settings in one CONFIG object
‚úÖ Clear documentation for each setting
‚úÖ Examples provided for major languages

### Client-Ready Features
‚úÖ Automatic duplicate prevention
‚úÖ Organized year/quarter folder structure
‚úÖ Automated data extraction with Vision API
‚úÖ Scheduled twice-daily runs
‚úÖ Email notifications on completion

---

**v1.4 is ready to deploy!** üöÄ
